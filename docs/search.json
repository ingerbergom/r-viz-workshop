[
  {
    "objectID": "r-viz-workshop.html",
    "href": "r-viz-workshop.html",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "",
    "text": "Clear the R environment. This removes all objects stored in your global environment.\n\nrm(list=ls())\n\nLoad packages. You may also need to install them first by running install.packages(\"dplyr\") and install.packages(\"ggplot2\").\n\ndplyr is a grammar of data manipulation\n\nggplot2 is for data visualization\n\n\nlibrary(dplyr)\nlibrary(ggplot2)\n\nSet working directory. You’ll need to customize this path for your own directory structure.\n\nsetwd(\"/Documents/S057\")\n\n\n\n\n\n\n\nTip\n\n\n\n\nUse RStudio Projects instead of setwd()\nWorkflow: Projects\nWhy You Should Always Use RStudio Projects\n\n\n\nLoad the data. You’ll need to customize the path for your own directory structure. If you need to download the data, you can find it here: bit.ly/s057-data.\n\ndat &lt;- read.csv(\"s057workshopdata.csv\")"
  },
  {
    "objectID": "r-viz-workshop.html#setup",
    "href": "r-viz-workshop.html#setup",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "",
    "text": "Clear the R environment. This removes all objects stored in your global environment.\n\nrm(list=ls())\n\nLoad packages. You may also need to install them first by running install.packages(\"dplyr\") and install.packages(\"ggplot2\").\n\ndplyr is a grammar of data manipulation\n\nggplot2 is for data visualization\n\n\nlibrary(dplyr)\nlibrary(ggplot2)\n\nSet working directory. You’ll need to customize this path for your own directory structure.\n\nsetwd(\"/Documents/S057\")\n\n\n\n\n\n\n\nTip\n\n\n\n\nUse RStudio Projects instead of setwd()\nWorkflow: Projects\nWhy You Should Always Use RStudio Projects\n\n\n\nLoad the data. You’ll need to customize the path for your own directory structure. If you need to download the data, you can find it here: bit.ly/s057-data.\n\ndat &lt;- read.csv(\"s057workshopdata.csv\")"
  },
  {
    "objectID": "r-viz-workshop.html#about-ggplot2",
    "href": "r-viz-workshop.html#about-ggplot2",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "About ggplot2",
    "text": "About ggplot2\nIn general, making graphs/figures in R is a matter of becoming familiar with the typical figure syntax as well as how it changes for certain types of figures. When we use ggplot2, we can essentially split our figure into the following basic parts:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\n\nDATA refers to the data frame (our data set).\nAESTHETICS indicates the x and y variables. It also tells R how to display data in the plot (e.g., what colors to use, the size and shape of points, etc.).\nGEOMETRY refers to the type of graphs (e.g., bar chart, histogram, box plot, line plot, etc.) to use."
  },
  {
    "objectID": "r-viz-workshop.html#line-graphs",
    "href": "r-viz-workshop.html#line-graphs",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Line Graphs",
    "text": "Line Graphs\nA line graph is really useful when you have data with a time component, or in other words, you are measuring the same things across different times. You can also use this to compare differences across time between different units. If there is a time component (years, months, etc.) try a line graph.\n\n\n\n\n\n\nExample Research Question\n\n\n\nHow has high school enrollment changed over time at 3 different sites (Cambridge Rindge and Latin, Boston Latin Academy, Brighton High School)?\n\n\nFirst,create a subset of our dataset that includes only the three schools relevant to our research question.\n\ndat_line &lt;- dat %&gt;% \n  filter(school == 'CAMBRIDGE RINDGE AND LATIN' | \n           school == 'BOSTON LATIN ACADEMY' | \n           school == 'BRIGHTON HIGH') \n\nRecall the basic ggplot2 structure:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\nNext, we’ll generate the plot. There are many ways to change the style of the graph and how the lines look, but note that lines should cover about 2/3 of the chart height. We want to clearly see where each of these lines appears relative to the y-axis. For now, let’s change the maximum bound of the y-axis to 3000 see if we prefer it.\n\nggplot(dat_line, aes(x = year, y = enrollment, color = school)) +\n  geom_line()\n\n\n\n\n\n\n\n\nWe can also add a title to our graph, update our legend, and update our axis labels:\n\nggplot(dat_line, aes(x = year, y = enrollment, color = school)) +\n  geom_line() +\n  ylim(0, 3000) +\n  scale_color_discrete(labels = c(\"Boston Latin\", \"Brighton\", \"Cambridge\")) + # update legend\n  ggtitle(\"This is our useful takeaway title.\") +  # add a title\n  labs(color = \"School\",   # update our legend label\n       x = \"Year\",         # update our x-axis label\n       y = \"Enrollment\")   # update our y-axis label\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nWhen you use scale_color_discrete(labels = c()), R will not know how to match your labels to the data; essentially we are just “overriding” the default labels R will use. You will need to verify manually that your labels match the actual data."
  },
  {
    "objectID": "r-viz-workshop.html#bar-graphs",
    "href": "r-viz-workshop.html#bar-graphs",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Bar Graphs",
    "text": "Bar Graphs\nA bar graph is really useful when you have data that you want to rank. Or when you have data within groups that you want to show the differences between, such as something like differences in salary between men and women. Finally, you can use a bar graph to show a distribution of a variable - that is, the range and frequency of all possible values. This is called a histogram, and we’ll talk about that separately. Basically, if there are categories and you are interested in highlighting the differences between them, try a bar graph.\n\n\n\n\n\n\nExample Research Question\n\n\n\nHow does racial composition of schools differ between Cambridge and Boston public schools, on average?\n\n\nFirst, we create a new dataset called data_bar. Then we aggregate by district and calculate percent of enrollment by race.\n\ndat_bar &lt;- dat %&gt;%            \n  group_by(district) %&gt;%    \n  summarize(avg_pct_black = mean(black / enrollment, na.rm = TRUE), \n            avg_pct_hispanic = mean(hispanic / enrollment, na.rm = TRUE),\n            avg_pct_asian = mean(asian / enrollment, na.rm = TRUE),\n            avg_pct_white = mean(white / enrollment, na.rm = TRUE))\n\n\n\n\n\n\n\nWarning\n\n\n\nWhen we run this code, get an error that we have a non-numeric argument. This is likely because R thinks our race counts by school are not numbers.\n\n\nTo fix the error, let’s tell R to change the “class” (i.e., type of variable) to be numeric.\n\ndat$hispanic &lt;- as.numeric(dat$hispanic)\ndat$black &lt;- as.numeric(dat$black)\ndat$asian &lt;- as.numeric(dat$asian)\ndat$white &lt;- as.numeric(dat$white)\ndat$enrollment &lt;- as.numeric(dat$enrollment)\n\nNow let’s try making the new dataset again:\n\ndat_bar &lt;- dat %&gt;%            \n  group_by(district) %&gt;%     \n  summarize(avg_pct_black = mean(black / enrollment, na.rm = TRUE),\n            avg_pct_hispanic = mean(hispanic / enrollment, na.rm = TRUE),\n            avg_pct_asian = mean(asian / enrollment, na.rm = TRUE),\n            avg_pct_white = mean(white / enrollment, na.rm = TRUE))\n\nTo help with our chart, let’s swap our rows and columns. We’ll need the tidyr package to do this. If you already have it installed, you only need to load it from your library.\n\ninstall.packages(\"tidyr\")\nlibrary(tidyr)\n\nNow we’ll modify the dat_bar data frame to use it for the bar chart:\n\ndat_bar &lt;- dat_bar %&gt;%\n  pivot_longer(cols = starts_with(\"avg\"), # Select columns starting with \"avg\"\n               names_to = \"race\",  # New column name for racial categories\n               values_to = \"average_enrollment\")  # New column name for avg enrollment\n\nNext, we’re ready to make the bar chart. Recall the basic structure we use for ggplot2:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\n\nggplot(dat_bar, aes(x = race, y = average_enrollment, fill = district)) +\n  geom_bar(stat = \"identity\", position = \"dodge\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nstat = \"identity\" tells R that the height of each bar is determined by the y-values in the data. The code position = \"dodge\" tells R that the bars within each group should be placed next to each other instead of stacking them.\n\n\nLike with the line chart, we can make our plot fancier:\n\nggplot(dat_bar, aes(x = race, y = average_enrollment, fill = district)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  scale_fill_discrete(labels = c(\"Boston\", \"Cambridge\")) + #update legend labels\n  ggtitle(\"This is our useful takeaway title.\") + # add a title\n  labs(fill = \"District\", #update our legend and axis labels\n       x = \"\",\n       y = \"Average Percentage\")  +\n    scale_x_discrete(labels = c(\"avg_pct_black\" = \"Black\",     #change x-labels\n                                \"avg_pct_hispanic\" = \"Hispanic\",\n                                \"avg_pct_asian\" = \"Asian\",\n                                \"avg_pct_white\" = \"White\")) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nAn important stylistic point with bar graphs is that you always want to start with a baseline (the beginning of your y-axis) at zero. Doing otherwise can lead to people misinterpreting your data.\n\n\nLet’s finish by setting the y-axis baseline to start at zero by specifying the range for y:\n\nggplot(dat_bar, aes(x = race, y = average_enrollment, fill = district)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  scale_fill_discrete(labels = c(\"Boston\", \"Cambridge\")) + \n  ggtitle(\"This is our useful takeaway title.\") + \n  labs(fill = \"District\", \n       x = \"\",\n       y = \"Average Percentage\")  +\n  scale_x_discrete(labels = c(\"avg_pct_black\" = \"Black\",     \n                              \"avg_pct_hispanic\" = \"Hispanic\",\n                              \"avg_pct_asian\" = \"Asian\",\n                              \"avg_pct_white\" = \"White\")) +\n  ylim(0, 0.5) # set range for y"
  },
  {
    "objectID": "r-viz-workshop.html#histograms",
    "href": "r-viz-workshop.html#histograms",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Histograms",
    "text": "Histograms\nHistograms are a special type of bar chart that allows you to visually observe the distribution of a single variable. This is especially useful for a continuous variable that has lots of observations. Say you want to understand the distribution of test scores for students in a school. In that case, a histogram would work really well.\n\n\n\n\n\n\nExample Research Question\n\n\n\nHow does school size vary in BPS?\n\n\nFirst, we’ll create a subset of our dataset that includes only the schools in boston.\n\ndat_hist &lt;- dat %&gt;% filter(district == 'boston')\n\nRecall the general ggplot2 structure: &gt; PLOT = DATA + AESTHETICS + GEOMETRY\n\nggplot(dat_hist, aes(x = enrollment)) +\n  geom_histogram(binwidth = 100) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nFor histograms we don’t indicate a y-variable because by definition the y-axis for a histogram will be a tally or a count.\n\n\nFor a histogram, a choice you are going to make is how many bins (categories) you want your histogram to have. Make sure you have enough bins to be able to see the distribution, but not too many bins that your graph gets messy. The binwidth tells stata how big to set the “buckets.” For now, let’s change the binwidth to 50 to get a little more granular.\nLet’s add a title and update the labels.\n\nggplot(dat_hist, aes(x = enrollment)) +\n  geom_histogram(binwidth = 50) +\n  ggtitle(\"This is our useful takeaway title.\") + # add a title\n  labs(x = \"Enrollment\", # add axis labels\n     y = \"Count\")"
  },
  {
    "objectID": "r-viz-workshop.html#scatterplots",
    "href": "r-viz-workshop.html#scatterplots",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Scatterplots",
    "text": "Scatterplots\nScatterplots are similar to histograms in that they show you the distribution of a variable. However, they can be much more detailed in that they can show you each individual data point on a chart. More importantly, they allow you to add a second variable to the chart, allowing you to see its distribution, which is really useful if you are interested in knowing if two variables are related or correlated with each other in some way. A scatterplot also allows you to easily identify outliers in your data.\n\n\n\n\n\n\nExample Research Question\n\n\n\nDo white students tend to go to schools where fewer students receive free lunch?\n\n\nLet’s practice making a scatterplot by looking at the relationship between white student proportion and the proportion of students who receive free lunch in Boston and Cambridge Public Schools.\nFirst, create a new data frame based on our original dataset.\n\ndat_scat &lt;- dat #duplicate our dataset\n\nThen make new variables for percent white and percent free lunch.\n\ndat_scat$pct_white &lt;- dat_scat$white / dat_scat$enrollment\ndat_scat$pct_freelunch &lt;- dat_scat$freelunch / dat_scat$enrollment\n\nRecall the ggplot2 structure:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\nMake the basic scatterplot:\n\nggplot(dat_scat, aes(x = pct_white, y = pct_freelunch)) +\n  geom_point()\n\n\n\n\n\n\n\n\nLet’s add a title and make a few other updates:\n\nggplot(dat_scat, aes(x = pct_white, y = pct_freelunch)) +\ngeom_point(color = \"blue\", size = 1) + # make our dots blue and small\n  ggtitle(\"This is our useful takeaway title.\") +  #add a title\n  labs(x = \"X-Axis Label\",    #update the axes\n       y = \"Y-Axis Label\")"
  },
  {
    "objectID": "r-viz-workshop.html#practice-on-your-own",
    "href": "r-viz-workshop.html#practice-on-your-own",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Practice on Your Own",
    "text": "Practice on Your Own\nCreate a line graph that shows how black student enrollment as a proportion of total school enrollment has changed between 2013-2017.\nCreate a bar graph that shows the enrollment proportion by race for Cambridge High School and Boston Latin Academy.\nCreate a histogram that shows the distribution of the proportion of students that are Black in Boston public schools in 2017.\nCreate a scatterplot that shows the relationship between school size and % of students on free lunch."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "",
    "text": "Download the workshop data here.\nDownload the R script file here."
  },
  {
    "objectID": "index.html#setup",
    "href": "index.html#setup",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Setup",
    "text": "Setup\nClear the R environment. This removes all objects stored in your global environment.\n\nrm(list=ls())\n\nLoad packages. You may also need to install them first by running install.packages(\"dplyr\") and install.packages(\"ggplot2\").\n\ndplyr is a grammar of data manipulation\n\nggplot2 is for data visualization\n\n\nlibrary(dplyr)\nlibrary(ggplot2)\n\nSet working directory. You’ll need to customize this path for your own directory structure.\n\nsetwd(\"/Documents/S057\")\n\n\n\n\n\n\n\nTip\n\n\n\n\nUse RStudio Projects instead of setwd()\nWorkflow: Projects\nWhy You Should Always Use RStudio Projects\n\n\n\nLoad the data. You’ll need to customize the path for your own directory structure. If you need to download the data, you can find it here: bit.ly/s057-data.\n\ndat &lt;- read.csv(\"s057workshopdata.csv\")"
  },
  {
    "objectID": "index.html#about-ggplot2",
    "href": "index.html#about-ggplot2",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "About ggplot2",
    "text": "About ggplot2\nIn general, making graphs/figures in R is a matter of becoming familiar with the typical figure syntax as well as how it changes for certain types of figures. When we use ggplot2, we can essentially split our figure into the following basic parts:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\n\nDATA refers to the data frame (our data set).\nAESTHETICS indicates the x and y variables. It also tells R how to display data in the plot (e.g., what colors to use, the size and shape of points, etc.).\nGEOMETRY refers to the type of graphs (e.g., bar chart, histogram, box plot, line plot, etc.) to use."
  },
  {
    "objectID": "index.html#line-graphs",
    "href": "index.html#line-graphs",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Line Graphs",
    "text": "Line Graphs\nA line graph is really useful when you have data with a time component, or in other words, you are measuring the same things across different times. You can also use this to compare differences across time between different units. If there is a time component (years, months, etc.) try a line graph.\n\n\n\n\n\n\nExample Research Question\n\n\n\nHow has high school enrollment changed over time at three different sites: Cambridge Rindge and Latin, Boston Latin Academy, and Brighton High School?\n\n\nFirst, create a subset of our dataset that includes only the three schools relevant to our research question.\n\ndat_line &lt;- dat %&gt;% \n  filter(school == 'CAMBRIDGE RINDGE AND LATIN' | \n           school == 'BOSTON LATIN ACADEMY' | \n           school == 'BRIGHTON HIGH') \n\nRecall the basic ggplot2 structure:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\nNext, we’ll generate the plot. There are many ways to change the style of the graph and how the lines look, but note that lines should cover about 2/3 of the chart height. We want to clearly see where each of these lines appears relative to the y-axis. For now, let’s change the maximum bound of the y-axis to 3000 see if we prefer it.\n\nggplot(dat_line, aes(x = year, y = enrollment, color = school)) +\n  geom_line()\n\n\n\n\n\n\n\n\nWe can also add a title to our graph, update our legend, and update our axis labels:\n\nggplot(dat_line, aes(x = year, y = enrollment, color = school)) +\n  geom_line() +\n  ylim(0, 3000) +\n  scale_color_discrete(labels = c(\"Boston Latin\", \"Brighton\", \"Cambridge\")) + # update legend\n  ggtitle(\"This is our useful takeaway title.\") +  # add a title\n  labs(color = \"School\",   # update our legend label\n       x = \"Year\",         # update our x-axis label\n       y = \"Enrollment\")   # update our y-axis label\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nWhen you use scale_color_discrete(labels = c()), R will not know how to match your labels to the data; essentially we are just “overriding” the default labels R will use. You will need to verify manually that your labels match the actual data."
  },
  {
    "objectID": "index.html#bar-graphs",
    "href": "index.html#bar-graphs",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Bar Graphs",
    "text": "Bar Graphs\nA bar graph is really useful when you have data that you want to rank. Or when you have data within groups that you want to show the differences between, such as something like differences in salary between men and women. Finally, you can use a bar graph to show a distribution of a variable - that is, the range and frequency of all possible values. This is called a histogram, and we’ll talk about that separately. Basically, if there are categories and you are interested in highlighting the differences between them, try a bar graph.\n\n\n\n\n\n\nExample Research Question\n\n\n\nHow does racial composition of schools differ between Cambridge and Boston public schools, on average?\n\n\nFirst, we create a new dataset called data_bar. Then we aggregate by district and calculate percent of enrollment by race.\n\ndat_bar &lt;- dat %&gt;%            \n  group_by(district) %&gt;%    \n  summarize(avg_pct_black = mean(black / enrollment, na.rm = TRUE), \n            avg_pct_hispanic = mean(hispanic / enrollment, na.rm = TRUE),\n            avg_pct_asian = mean(asian / enrollment, na.rm = TRUE),\n            avg_pct_white = mean(white / enrollment, na.rm = TRUE))\n\n\n\n\n\n\n\nWarning\n\n\n\nWhen we run this code, we get an error that we have a non-numeric argument. This is likely because R thinks our race counts by school are not numbers.\n\n\nTo fix the error, let’s tell R to change the “class” (i.e., type of variable) to be numeric.\n\ndat$hispanic &lt;- as.numeric(dat$hispanic)\ndat$black &lt;- as.numeric(dat$black)\ndat$asian &lt;- as.numeric(dat$asian)\ndat$white &lt;- as.numeric(dat$white)\ndat$enrollment &lt;- as.numeric(dat$enrollment)\n\nNow let’s try making the new dataset again:\n\ndat_bar &lt;- dat %&gt;%            \n  group_by(district) %&gt;%     \n  summarize(avg_pct_black = mean(black / enrollment, na.rm = TRUE),\n            avg_pct_hispanic = mean(hispanic / enrollment, na.rm = TRUE),\n            avg_pct_asian = mean(asian / enrollment, na.rm = TRUE),\n            avg_pct_white = mean(white / enrollment, na.rm = TRUE))\n\nTo help with our chart, let’s swap our rows and columns. We’ll need the tidyr package to do this. If you already have it installed, you only need to load it from your library.\n\ninstall.packages(\"tidyr\")\nlibrary(tidyr)\n\nNow we’ll modify the dat_bar data frame to use it for the bar chart:\n\ndat_bar &lt;- dat_bar %&gt;%\n  pivot_longer(cols = starts_with(\"avg\"), # Select columns starting with \"avg\"\n               names_to = \"race\",  # New column name for racial categories\n               values_to = \"average_enrollment\")  # New column name for avg enrollment\n\nNext, we’re ready to make the bar chart. Recall the basic structure we use for ggplot2:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\n\nggplot(dat_bar, aes(x = race, y = average_enrollment, fill = district)) +\n  geom_bar(stat = \"identity\", position = \"dodge\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nstat = \"identity\" tells R that the height of each bar is determined by the y-values in the data. The code position = \"dodge\" tells R that the bars within each group should be placed next to each other instead of stacking them.\n\n\nLike with the line chart, we can make our plot fancier:\n\nggplot(dat_bar, aes(x = race, y = average_enrollment, fill = district)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  scale_fill_discrete(labels = c(\"Boston\", \"Cambridge\")) + #update legend labels\n  ggtitle(\"This is our useful takeaway title.\") + # add a title\n  labs(fill = \"District\", #update our legend and axis labels\n       x = \"\",\n       y = \"Average Percentage\")  +\n    scale_x_discrete(labels = c(\"avg_pct_black\" = \"Black\",     #change x-labels\n                                \"avg_pct_hispanic\" = \"Hispanic\",\n                                \"avg_pct_asian\" = \"Asian\",\n                                \"avg_pct_white\" = \"White\")) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nAn important stylistic point with bar graphs is that you always want to start with a baseline (the beginning of your y-axis) at zero. Doing otherwise can lead to people misinterpreting your data.\n\n\nLet’s finish by setting the y-axis scale with scale_y_continuous and removing the padding by using the expand argument:\n\nggplot(dat_bar, aes(x = race, y = average_enrollment, fill = district)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  scale_fill_discrete(labels = c(\"Boston\", \"Cambridge\")) + \n  ggtitle(\"This is our useful takeaway title.\") + \n  labs(fill = \"District\", \n       x = \"\",\n       y = \"Average Percentage\")  +\n  scale_x_discrete(labels = c(\"avg_pct_black\" = \"Black\",     \n                              \"avg_pct_hispanic\" = \"Hispanic\",\n                              \"avg_pct_asian\" = \"Asian\",\n                              \"avg_pct_white\" = \"White\")) +\n  scale_y_continuous(limits = c(0, 0.5), expand = c(0, 0)) # Start y-axis at 0 with no extra space"
  },
  {
    "objectID": "index.html#histograms",
    "href": "index.html#histograms",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Histograms",
    "text": "Histograms\nHistograms are a special type of bar chart that allows you to visually observe the distribution of a single variable. This is especially useful for a continuous variable that has lots of observations. Say you want to understand the distribution of test scores for students in a school. In that case, a histogram would work really well.\n\n\n\n\n\n\nExample Research Question\n\n\n\nHow does school size vary in BPS?\n\n\nFirst, we’ll create a subset of our dataset that includes only the schools in boston.\n\ndat_hist &lt;- dat %&gt;% filter(district == 'boston')\n\nRecall the general ggplot2 structure: &gt; PLOT = DATA + AESTHETICS + GEOMETRY\n\nggplot(dat_hist, aes(x = enrollment)) +\n  geom_histogram(binwidth = 100) \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nFor histograms we don’t indicate a y-variable because by definition the y-axis for a histogram will be a tally or a count.\n\n\nFor a histogram, a choice you are going to make is how many bins (categories) you want your histogram to have. Make sure you have enough bins to be able to see the distribution, but not too many bins that your graph gets messy. The binwidth tells stata how big to set the “buckets.” For now, let’s change the binwidth to 50 to get a little more granular.\nLet’s add a title and update the labels.\n\nggplot(dat_hist, aes(x = enrollment)) +\n  geom_histogram(binwidth = 50) +\n  ggtitle(\"This is our useful takeaway title.\") + # add a title\n  labs(x = \"Enrollment\", # add axis labels\n     y = \"Count\")"
  },
  {
    "objectID": "index.html#scatterplots",
    "href": "index.html#scatterplots",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Scatterplots",
    "text": "Scatterplots\nScatterplots are similar to histograms in that they show you the distribution of a variable. However, they can be much more detailed in that they can show you each individual data point on a chart. More importantly, they allow you to add a second variable to the chart, allowing you to see its distribution, which is really useful if you are interested in knowing if two variables are related or correlated with each other in some way. A scatterplot also allows you to easily identify outliers in your data.\n\n\n\n\n\n\nExample Research Question\n\n\n\nDo white students tend to go to schools where fewer students receive free lunch?\n\n\nLet’s practice making a scatterplot by looking at the relationship between white student proportion and the proportion of students who receive free lunch in Boston and Cambridge Public Schools.\nFirst, create a new data frame based on our original dataset.\n\ndat_scat &lt;- dat #duplicate our dataset\n\nThen make new variables for percent white and percent free lunch.\n\ndat_scat$pct_white &lt;- dat_scat$white / dat_scat$enrollment\ndat_scat$pct_freelunch &lt;- dat_scat$freelunch / dat_scat$enrollment\n\nRecall the ggplot2 structure:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\nMake the basic scatterplot:\n\nggplot(dat_scat, aes(x = pct_white, y = pct_freelunch)) +\n  geom_point()\n\n\n\n\n\n\n\n\nLet’s add a title and make a few other updates:\n\nggplot(dat_scat, aes(x = pct_white, y = pct_freelunch)) +\ngeom_point(color = \"blue\", size = 1) + # make our dots blue and small\n  ggtitle(\"This is our useful takeaway title.\") +  #add a title\n  labs(x = \"X-Axis Label\",    #update the axes\n       y = \"Y-Axis Label\")"
  },
  {
    "objectID": "index.html#practice-on-your-own",
    "href": "index.html#practice-on-your-own",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Practice on Your Own",
    "text": "Practice on Your Own\nCreate a line graph that shows how black student enrollment as a proportion of total school enrollment has changed between 2013-2017.\nCreate a bar graph that shows the enrollment proportion by race for Cambridge High School and Boston Latin Academy.\nCreate a histogram that shows the distribution of the proportion of students that are Black in Boston public schools in 2017.\nCreate a scatterplot that shows the relationship between school size and % of students on free lunch."
  },
  {
    "objectID": "index.html#additional-resources",
    "href": "index.html#additional-resources",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Additional Resources",
    "text": "Additional Resources\n\nLearning ggplot2. There are lots of resources online for learning ggplot2. Here are a few:\n\nIntroduction to ggplot2\nggplot2 book by Hadley Wickham\nggplot2 documentation\n\nMaking pretty tables. My favorite R packages for making tables are gt and tinytable. This page lists various other packages.\nMaking charts and tables interactive. One way to make interactive charts and tables in R is with HTML widgets. A few are featured in this post I wrote a while back."
  },
  {
    "objectID": "index.html#workshop-materials",
    "href": "index.html#workshop-materials",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "",
    "text": "Download the workshop data here.\nDownload the R script file here."
  },
  {
    "objectID": "index.knit.html",
    "href": "index.knit.html",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "",
    "text": "title: “S057 Workshop: Data Vizualization with R”\ndate: today\ndate-format: “MMMM YYYY”\nauthor: Inger Bergom, adpated from Liz Salinas\nformat:\nhtml:\neditor: visual\nexecute:\nwarning: false"
  },
  {
    "objectID": "index.knit.html#workshop-materials",
    "href": "index.knit.html#workshop-materials",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Workshop Materials",
    "text": "Workshop Materials\nDownload the workshop data here: bit.ly/s057-data.\nDownload the R script file here: bit.ly/s057-data."
  },
  {
    "objectID": "index.knit.html#setup",
    "href": "index.knit.html#setup",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Setup",
    "text": "Setup\nClear the R environment. This removes all objects stored in your global environment.\n\nrm(list=ls())\n\nLoad packages. You may also need to install them first by running install.packages(\"dplyr\") and install.packages(\"ggplot2\").\n\ndplyr is a grammar of data manipulation\n\nggplot2 is for data visualization\n\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(ggplot2)\n\nSet working directory. You’ll need to customize this path for your own directory structure.\n\nsetwd(\"/Documents/S057\")\n\n\n\n\n\n\n\nTip\n\n\n\n\nUse RStudio Projects instead of setwd()\n\n\n\nWorkflow: Projects\n\n\n\nWhy You Should Always Use RStudio Projects\n\n\n\nLoad the data. You’ll need to customize the path for your own directory structure.\n\ndat &lt;- read.csv(\"s057workshopdata.csv\")"
  },
  {
    "objectID": "index.knit.html#about-ggplot2",
    "href": "index.knit.html#about-ggplot2",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "About ggplot2",
    "text": "About ggplot2\nIn general, making graphs/figures in R is a matter of becoming familiar with the typical figure syntax as well as how it changes for certain types of figures. When we use ggplot2, we can essentially split our figure into the following basic parts:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\n\nDATA refers to the data frame (our data set).\nAESTHETICS indicates the x and y variables. It also tells R how to display data in the plot (e.g., what colors to use, the size and shape of points, etc.).\nGEOMETRY refers to the type of graphs (e.g., bar chart, histogram, box plot, line plot, etc.) to use."
  },
  {
    "objectID": "index.knit.html#line-graphs",
    "href": "index.knit.html#line-graphs",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Line Graphs",
    "text": "Line Graphs\nA line graph is really useful when you have data with a time component, or in other words, you are measuring the same things across different times. You can also use this to compare differences across time between different units. If there is a time component (years, months, etc.) try a line graph.\n\n\n\n\n\n\nExample Research Question\n\n\n\nHow has high school enrollment changed over time at three different sites: Cambridge Rindge and Latin, Boston Latin Academy, and Brighton High School?\n\n\nFirst, create a subset of our dataset that includes only the three schools relevant to our research question.\n\ndat_line &lt;- dat %&gt;%\n\n  filter(school == 'CAMBRIDGE RINDGE AND LATIN' |\n\n           school == 'BOSTON LATIN ACADEMY' |\n\n           school == 'BRIGHTON HIGH')\n\nRecall the basic ggplot2 structure:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\nNext, we’ll generate the plot. There are many ways to change the style of the graph and how the lines look, but note that lines should cover about 2/3 of the chart height. We want to clearly see where each of these lines appears relative to the y-axis. For now, let’s change the maximum bound of the y-axis to 3000 see if we prefer it.\n\nggplot(dat_line, aes(x = year, y = enrollment, color = school)) +\n\n  geom_line()\n\n\n\n\n\n\n\n\nWe can also add a title to our graph, update our legend, and update our axis labels:\n\nggplot(dat_line, aes(x = year, y = enrollment, color = school)) +\n\n  geom_line() +\n\n  ylim(0, 3000) +\n\n  scale_color_discrete(labels = c(\"Boston Latin\", \"Brighton\", \"Cambridge\")) + # update legend\n\n  ggtitle(\"This is our useful takeaway title.\") +  # add a title\n\n  labs(color = \"School\",   # update our legend label\n\n       x = \"Year\",         # update our x-axis label\n\n       y = \"Enrollment\")   # update our y-axis label\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nWhen you use scale_color_discrete(labels = c()), R will not know how to match your labels to the data; essentially we are just “overriding” the default labels R will use. You will need to verify manually that your labels match the actual data."
  },
  {
    "objectID": "index.knit.html#bar-graphs",
    "href": "index.knit.html#bar-graphs",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Bar Graphs",
    "text": "Bar Graphs\nA bar graph is really useful when you have data that you want to rank. Or when you have data within groups that you want to show the differences between, such as something like differences in salary between men and women. Finally, you can use a bar graph to show a distribution of a variable - that is, the range and frequency of all possible values. This is called a histogram, and we’ll talk about that separately. Basically, if there are categories and you are interested in highlighting the differences between them, try a bar graph.\n\n\n\n\n\n\nExample Research Question\n\n\n\nHow does racial composition of schools differ between Cambridge and Boston public schools, on average?\n\n\nFirst, we create a new dataset called data_bar. Then we aggregate by district and calculate percent of enrollment by race.\n\ndat_bar &lt;- dat %&gt;%           \n\n  group_by(district) %&gt;%   \n\n  summarize(avg_pct_black = mean(black / enrollment, na.rm = TRUE),\n\n            avg_pct_hispanic = mean(hispanic / enrollment, na.rm = TRUE),\n\n            avg_pct_asian = mean(asian / enrollment, na.rm = TRUE),\n\n            avg_pct_white = mean(white / enrollment, na.rm = TRUE))\n\n\n\n\n\n\n\nWarning\n\n\n\nWhen we run this code, we get an error that we have a non-numeric argument. This is likely because R thinks our race counts by school are not numbers.\n\n\nTo fix the error, let’s tell R to change the “class” (i.e., type of variable) to be numeric.\n\ndat$hispanic &lt;- as.numeric(dat$hispanic)\n\ndat$black &lt;- as.numeric(dat$black)\n\ndat$asian &lt;- as.numeric(dat$asian)\n\nWarning: NAs introduced by coercion\n\ndat$white &lt;- as.numeric(dat$white)\n\ndat$enrollment &lt;- as.numeric(dat$enrollment)\n\nNow let’s try making the new dataset again:\n\ndat_bar &lt;- dat %&gt;%           \n\n  group_by(district) %&gt;%    \n\n  summarize(avg_pct_black = mean(black / enrollment, na.rm = TRUE),\n\n            avg_pct_hispanic = mean(hispanic / enrollment, na.rm = TRUE),\n\n            avg_pct_asian = mean(asian / enrollment, na.rm = TRUE),\n\n            avg_pct_white = mean(white / enrollment, na.rm = TRUE))\n\nTo help with our chart, let’s swap our rows and columns. We’ll need the tidyr package to do this. If you already have it installed, you only need to load it from your library.\n\ninstall.packages(\"tidyr\")\n\nlibrary(tidyr)\n\nNow we’ll modify the dat_bar data frame to use it for the bar chart:\n\ndat_bar &lt;- dat_bar %&gt;%\n\n  pivot_longer(cols = starts_with(\"avg\"), # Select columns starting with \"avg\"\n\n               names_to = \"race\",  # New column name for racial categories\n\n               values_to = \"average_enrollment\")  # New column name for avg enrollment\n\nNext, we’re ready to make the bar chart. Recall the basic structure we use for ggplot2:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\n\nggplot(dat_bar, aes(x = race, y = average_enrollment, fill = district)) +\n\n  geom_bar(stat = \"identity\", position = \"dodge\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nstat = \"identity\" tells R that the height of each bar is determined by the y-values in the data. The code position = \"dodge\" tells R that the bars within each group should be placed next to each other instead of stacking them.\n\n\nLike with the line chart, we can make our plot fancier:\n\nggplot(dat_bar, aes(x = race, y = average_enrollment, fill = district)) +\n\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n\n  scale_fill_discrete(labels = c(\"Boston\", \"Cambridge\")) + #update legend labels\n\n  ggtitle(\"This is our useful takeaway title.\") + # add a title\n\n  labs(fill = \"District\", #update our legend and axis labels\n\n       x = \"\",\n\n       y = \"Average Percentage\")  +\n\n    scale_x_discrete(labels = c(\"avg_pct_black\" = \"Black\",     #change x-labels\n\n                                \"avg_pct_hispanic\" = \"Hispanic\",\n\n                                \"avg_pct_asian\" = \"Asian\",\n\n                                \"avg_pct_white\" = \"White\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nAn important stylistic point with bar graphs is that you always want to start with a baseline (the beginning of your y-axis) at zero. Doing otherwise can lead to people misinterpreting your data.\n\n\nLet’s finish by setting the y-axis scale with scale_y_continuous and removing the padding by using the expand argument:\n\nggplot(dat_bar, aes(x = race, y = average_enrollment, fill = district)) +\n\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n\n  scale_fill_discrete(labels = c(\"Boston\", \"Cambridge\")) +\n\n  ggtitle(\"This is our useful takeaway title.\") +\n\n  labs(fill = \"District\",\n\n       x = \"\",\n\n       y = \"Average Percentage\")  +\n\n  scale_x_discrete(labels = c(\"avg_pct_black\" = \"Black\",    \n\n                              \"avg_pct_hispanic\" = \"Hispanic\",\n\n                              \"avg_pct_asian\" = \"Asian\",\n\n                              \"avg_pct_white\" = \"White\")) +\n\n  scale_y_continuous(limits = c(0, 0.5), expand = c(0, 0)) # Start y-axis at 0 with no extra space"
  },
  {
    "objectID": "index.knit.html#histograms",
    "href": "index.knit.html#histograms",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Histograms",
    "text": "Histograms\nHistograms are a special type of bar chart that allows you to visually observe the distribution of a single variable. This is especially useful for a continuous variable that has lots of observations. Say you want to understand the distribution of test scores for students in a school. In that case, a histogram would work really well.\n\n\n\n\n\n\nExample Research Question\n\n\n\nHow does school size vary in BPS?\n\n\nFirst, we’ll create a subset of our dataset that includes only the schools in boston.\n\ndat_hist &lt;- dat %&gt;% filter(district == 'boston')\n\nRecall the general ggplot2 structure: &gt; PLOT = DATA + AESTHETICS + GEOMETRY\n\nggplot(dat_hist, aes(x = enrollment)) +\n\n  geom_histogram(binwidth = 100)\n\nWarning: Removed 5 rows containing non-finite outside the scale range\n(`stat_bin()`).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nFor histograms we don’t indicate a y-variable because by definition the y-axis for a histogram will be a tally or a count.\n\n\nFor a histogram, a choice you are going to make is how many bins (categories) you want your histogram to have. Make sure you have enough bins to be able to see the distribution, but not too many bins that your graph gets messy. The binwidth tells stata how big to set the “buckets.” For now, let’s change the binwidth to 50 to get a little more granular.\nLet’s add a title and update the labels.\n\nggplot(dat_hist, aes(x = enrollment)) +\n\n  geom_histogram(binwidth = 50) +\n\n  ggtitle(\"This is our useful takeaway title.\") + # add a title\n\n  labs(x = \"Enrollment\", # add axis labels\n\n     y = \"Count\")\n\nWarning: Removed 5 rows containing non-finite outside the scale range\n(`stat_bin()`)."
  },
  {
    "objectID": "index.knit.html#scatterplots",
    "href": "index.knit.html#scatterplots",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Scatterplots",
    "text": "Scatterplots\nScatterplots are similar to histograms in that they show you the distribution of a variable. However, they can be much more detailed in that they can show you each individual data point on a chart. More importantly, they allow you to add a second variable to the chart, allowing you to see its distribution, which is really useful if you are interested in knowing if two variables are related or correlated with each other in some way. A scatterplot also allows you to easily identify outliers in your data.\n\n\n\n\n\n\nExample Research Question\n\n\n\nDo white students tend to go to schools where fewer students receive free lunch?\n\n\nLet’s practice making a scatterplot by looking at the relationship between white student proportion and the proportion of students who receive free lunch in Boston and Cambridge Public Schools.\nFirst, create a new data frame based on our original dataset.\n\ndat_scat &lt;- dat #duplicate our dataset\n\nThen make new variables for percent white and percent free lunch.\n\ndat_scat$pct_white &lt;- dat_scat$white / dat_scat$enrollment\n\ndat_scat$pct_freelunch &lt;- dat_scat$freelunch / dat_scat$enrollment\n\nRecall the ggplot2 structure:\n\nPLOT = DATA + AESTHETICS + GEOMETRY\n\nMake the basic scatterplot:\n\nggplot(dat_scat, aes(x = pct_white, y = pct_freelunch)) +\n\n  geom_point()\n\nWarning: Removed 5 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nLet’s add a title and make a few other updates:\n\nggplot(dat_scat, aes(x = pct_white, y = pct_freelunch)) +\n\ngeom_point(color = \"blue\", size = 1) + # make our dots blue and small\n\n  ggtitle(\"This is our useful takeaway title.\") +  #add a title\n\n  labs(x = \"X-Axis Label\",    #update the axes\n\n       y = \"Y-Axis Label\")\n\nWarning: Removed 5 rows containing missing values or values outside the scale range\n(`geom_point()`)."
  },
  {
    "objectID": "index.knit.html#practice-on-your-own",
    "href": "index.knit.html#practice-on-your-own",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Practice on Your Own",
    "text": "Practice on Your Own\nCreate a line graph that shows how black student enrollment as a proportion of total school enrollment has changed between 2013-2017.\nCreate a bar graph that shows the enrollment proportion by race for Cambridge High School and Boston Latin Academy.\nCreate a histogram that shows the distribution of the proportion of students that are Black in Boston public schools in 2017.\nCreate a scatterplot that shows the relationship between school size and % of students on free lunch."
  },
  {
    "objectID": "index.knit.html#additional-resources",
    "href": "index.knit.html#additional-resources",
    "title": "S057 Workshop: Data Vizualization with R",
    "section": "Additional Resources",
    "text": "Additional Resources\n\nLearning ggplot2. There are lots of materials online for learning ggplot2. Here are a few resources:\n\nIntroduction to ggplot2\nggplot2 book by Hadley Wickham\nggplot2 documentation\n\nMaking pretty tables. My favorite R packages for making tables are gt and tinytable. This page lists various other packages.\nMaking charts and tables interactive. One way to make interactive charts and tables in R is with HTML widgets. A few are featured in this post I wrote a while back."
  }
]